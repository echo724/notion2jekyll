# 원하는 데이터의 API 찾기
[공공데이터 포털](https://www.data.go.kr)
이곳에는 정부의 다양한 데이터들이 있고, 각 데이터들을 요청할 수 있는 API가 제공 되어있다. 
오늘 예제로 사용해볼 데이터는 미세먼지 데이터!
일단, api를 사용하기 위해서는 공공데이터 포털에 가입이 되어있어야한다. 가입은 간단하게 할 수 있으므로, 가입을 한 뒤 미세먼지를 검색.
![https://s3.us-west-2.amazonaws.com/secure.notion-static.com/105a95ac-b2ec-4eab-9a0e-c6a3f0797708/Screen_Shot_2020-07-02_at_11.14.10_AM.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAT73L2G45O3KS52Y5%2F20200702%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20200702T073056Z&X-Amz-Expires=86400&X-Amz-Signature=ad2dc4e6a655b181ff98c2d5161366f7651fc69900a80e2de877480dc8b83c2d&X-Amz-SignedHeaders=host](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/105a95ac-b2ec-4eab-9a0e-c6a3f0797708/Screen_Shot_2020-07-02_at_11.14.10_AM.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAT73L2G45O3KS52Y5%2F20200702%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20200702T073057Z&X-Amz-Expires=86400&X-Amz-Signature=1e34d367ffe5e926d97dc51f71bb71202e30144cfca4eecff58350ef4d64f2bc&X-Amz-SignedHeaders=host)
검색해보면, 오픈 API 항목에서 한국환경공단_대기오염 정보를 찾을 수 있다.
클릭해서 들어가보면,
![https://s3.us-west-2.amazonaws.com/secure.notion-static.com/83efdaf9-2c84-4d51-85e5-920d462f107f/Screen_Shot_2020-07-02_at_11.15.08_AM.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAT73L2G45O3KS52Y5%2F20200702%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20200702T073058Z&X-Amz-Expires=86400&X-Amz-Signature=0ef1a87f984a5265a29c85b287797f25d1b1f9dcb41269317fb984b547e3be8e&X-Amz-SignedHeaders=host](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/83efdaf9-2c84-4d51-85e5-920d462f107f/Screen_Shot_2020-07-02_at_11.15.08_AM.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAT73L2G45O3KS52Y5%2F20200702%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20200702T073059Z&X-Amz-Expires=86400&X-Amz-Signature=a016516e1e08841d1d1b0ed58d78490f35aab291ed9af9145487a0996a092707&X-Amz-SignedHeaders=host)
이렇게 API 정보가 뜨고, PC화면으로 본다면, 옆에 활용신청이라는 버튼이 뜬다.
![https://s3.us-west-2.amazonaws.com/secure.notion-static.com/a3f64660-1c18-4b44-84d8-42fac366812b/Screen_Shot_2020-07-02_at_11.15.34_AM.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAT73L2G45O3KS52Y5%2F20200702%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20200702T073059Z&X-Amz-Expires=86400&X-Amz-Signature=b36d5335ae69e36f3fe88d82b8ff2862a217bf73a8986330c63e4600501ebe1a&X-Amz-SignedHeaders=host](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/a3f64660-1c18-4b44-84d8-42fac366812b/Screen_Shot_2020-07-02_at_11.15.34_AM.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAT73L2G45O3KS52Y5%2F20200702%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20200702T073100Z&X-Amz-Expires=86400&X-Amz-Signature=fc4473915f5f7c8ae729b055a4a6cdc9a4b7e3c853046a3e7647647e32138126&X-Amz-SignedHeaders=host)
활용신청 버튼을 누르면, API사용 목적과 기타 정보를 적으라고 하는데, 간단히 적어주고 제출.
제출을 완료 했다면, 마이페이지에 들어가서 승인이 되었는지 확인한다. 보통 바로 승인을 해주는 것 같다. 아무튼, 승인된 api를 누르고, 서비스 정보에서 일반 인증키 ( ServiceKey )를 복사해서 저장한다. 이 코드가 api를 요청할때 필요한 서비스키!. 
다만, 이 상태로 단축어에서 이용하면, UTF-8로 인코딩이 되어있어 잘못된 서비스키라는 에러메세지를 보게 된다. 따라서 이 서비스키를 디코딩 해주어야한다.
[URL Decode and Encode - Online](https://www.urldecoder.org)
이 사이트의 첫 번째 블럭에다가 서비스키를 넣고 아래 Decode 버튼을 누르면, 디코딩 된 서비스키가 나온다. 이것을 복사해서 어딘가에다가 저장해둔다.
# API 요청 명령어
이 API에는 여러가지 데이터를 조회할 수 있지만, 이번에 볼 데이터는, 측정소별 실시간 측정정보이다.
이 정보를 조회하기 위해서는, 몇 가지 parameter가 필요한다. 이 내용은 참고문서에 적혀있고, 예시는 이렇게 되어있다.
```Plain Text
http://openapi.airkorea.or.kr/openapi/services/rest/ArpltnInforInqireSvc/getMsrstnAcctoRltmMesureDnsty?
serviceKey=서비스키&
numOfRows=10&
pageNo=1&
stationName=종로구&
dataTerm=DAILY&
ver=1.3&
```
일단 이런 형태로 되어있다. ( 한 눈에 보이기 하기 위해, 엔터로 구분해 놨다. 원래는 한 줄로 되어있다.)
첫번째 줄은 endpoint이다. 데이터를 요청할때, 어디에 요청할지에 대한 정보가 적혀있다.
그 아랫 줄 부터는 차례로 api를 요청할 때 필요한 parameter들이다. 
ServiceKey → 서비스 키이다. 이 것이 있어야 api를 요청할 수 있다.
numOfRows → 요청하는 데이터의 row 수이다.
pageNo → 요청하는 데이터의 페이지 수
stationName → 관측소 명 ([https://www.airkorea.or.kr/web/stationInfo?pMENU_NO=93](https://www.airkorea.or.kr/web/stationInfo?pMENU_NO=93) 여기서 관측소 명을 찾아볼 수 있다.)
dataTerm → DAILY, MONTH, 3MONTH 순으로 있다.
ver → 버전 넘버 (자세한 설명은 도큐멘트 안에 있다.)

그리고! ios 단축어에서 사용하기 위해서는 데이터 형태가 json 형태가 되어야 한다. 기본으로는 xml 데이터를 받기 때문에, 파라미터에 json 으로 달라고 하는 인자를 넣어야하는데, 이 걸 마지막에 넣어주면 된다.
&_returnType=json

필요한 인자들을 각 파라미터에 넣어주면 준비 끝.
2편에서는 이 데이터를 어떻게 단축어에서 요청하고 처리하는지를 다뤄볼 것이다.
